function ShellWriter(file) {    this.json = file;    this.file = new File(file.path + "/" + file.name.substring(0, file.name.length - 3) + "Assets.sh");    this.file.encoding = "ASCII";    this.file.lineFeed = "Unix";    this.file.open("w:");}ShellWriter.prototype.write = function(layers) {        this.file.writeln("# Batch script exported from AE");    this.file.writeln("#");    this.file.writeln("");            var exported = {};        for(var i = 0; i < layers.length; i++) {        var ly = layers[i];        if(ly.isVisible() && ly.isAsset()) {            var seq    = !ly.layer.source.mainSource.isStill;            var fps    = ly.layer.source.mainSource.displayFrameRate;            var alpha  = (ly.hasAlpha) ? " -a " : " ";            var vid    = !ly.layer.source.hasVideo;            var solid  = ly.layer.source.mainSource instanceof SolidSource;                                    var path   = ly.layer.source.mainSource.file.path;            var fname  = ly.layer.source.mainSource.file.name;                        var width  = ly.layer.source.width;            var height = ly.layer.source.height;            var scale  = (ExportSettings.widthThreshold / width).toFixed(3);                        var missing = ly.layer.source.footageMissing;            var commentOut = (missing) ? "# " : "";            var misWarn = (missing) ? " !! MISSING FILE !! " : "";                        var expPath = this.json.path + "/";            var seqPath = expPath + ly.uniqueName();                        if(exported[fname]) continue;            // Is sequence            if(seq && !vid) {                this.file.writeln("# Sequence: [" + width + " x " + height + "]" + misWarn);                this.file.writeln(commentOut + "mkdir " + seqPath);                this.file.writeln(commentOut + "cp -f " + path + "/*.png " + seqPath);                this.file.writeln(commentOut + "twosided.py " + scale + " " + seqPath + "/");                this.file.writeln(commentOut + "ffmpeg -i " + seqPath + "/" + ly.sequenceWildcard() + " -r " + fps + " -sameq " + expPath + "/" + ly.webmFileName() + " 2>/dev/null");                this.file.writeln(commentOut + "rm -r " + seqPath);                this.file.writeln("");            }                    // Is still image            if(!seq && !solid && !vid) {                this.file.writeln("# Image: [" + width + " x " + height + "]" + misWarn);                this.file.writeln(commentOut + "cp -f " + path +"/" + fname + " " + expPath);                this.file.writeln(commentOut + "twosided.py " + scale + " " + expPath + fname + " -j"); // -j = Always export stills as double JPEG                this.file.writeln("");            }                    // Is video?            if(vid && !seq) {                this.file.writeln("# Video not supported. File: " + path + "/" + fname + misWarn);            }                    exported[fname] = true;        }    }        this.file.close();}